<!DOCTYPE html>
<html lang="pt-BR" class="scroll-smooth">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Guia Interativo: Permiss√µes Unreal para Quest 3</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Chosen Palette: DevTool Blue -->
    <!-- Application Structure Plan: A task-oriented single-page application with a sticky sidebar for navigation between key stages of the permission management process: Understanding the 'Why' and 'How', Identifying permissions, Removing them with interactive code generators, checking Meta's policies in a filterable table, and a troubleshooting guide. This structure transforms a dense technical document into an interactive, step-by-step tool, improving usability and reducing developer error by guiding them through the process and generating the necessary code snippets. -->
    <!-- Visualization & Content Choices: Report Info: Manifest merge process -> Goal: Organize/Inform -> Viz/Method: HTML/CSS flowchart -> Interaction: Click/Hover for details -> Justification: Visually simplifies a complex abstract process. Report Info: Permission removal code -> Goal: Inform/Organize -> Viz/Method: Interactive code generator (HTML form + JS) -> Interaction: User input generates XML -> Justification: Automates a tedious and error-prone task. Report Info: Meta's permission policies table -> Goal: Compare/Organize -> Viz/Method: Filterable HTML table (JS) -> Interaction: Live search -> Justification: Makes finding specific policy information quick and efficient. Report Info: Troubleshooting steps -> Goal: Organize/Inform -> Viz/Method: Accordion list (HTML+JS) -> Interaction: Click to reveal -> Justification: Hides complex information until needed, reducing cognitive load. No Chart.js/Plotly.js needed. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        :root {
            --primary-bg: #f8fafc; /* slate-50 */
            --secondary-bg: #ffffff;
            --text-primary: #1e293b; /* slate-800 */
            --text-secondary: #475569; /* slate-600 */
            --accent: #0f766e; /* teal-700 */
            --accent-light: #ccfbf1; /* teal-50 */
            --border-color: #e2e8f0; /* slate-200 */
        }
        body {
            background-color: var(--primary-bg);
            color: var(--text-primary);
            font-family: 'Inter', sans-serif;
        }
        .nav-link {
            transition: all 0.2s ease-in-out;
            border-left: 3px solid transparent;
        }
        .nav-link.active {
            color: var(--accent);
            border-left-color: var(--accent);
            background-color: var(--accent-light);
        }
        .prose-custom h2 {
            font-size: 1.875rem;
            line-height: 2.25rem;
            font-weight: 700;
            color: var(--text-primary);
            border-bottom: 2px solid var(--border-color);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            margin-top: 2rem;
        }
         .prose-custom h3 {
            font-size: 1.5rem;
            line-height: 2rem;
            font-weight: 600;
            color: var(--text-primary);
            margin-top: 2rem;
            margin-bottom: 1rem;
        }
        .prose-custom p, .prose-custom li {
            color: var(--text-secondary);
            line-height: 1.75;
        }
        .prose-custom code {
            background-color: #f1f5f9; /* slate-100 */
            color: var(--accent);
            padding: 0.2rem 0.4rem;
            border-radius: 0.25rem;
            font-size: 0.9em;
        }
        .prose-custom pre {
            background-color: #0f172a; /* slate-900 */
            color: #e2e8f0; /* slate-200 */
            padding: 1rem;
            border-radius: 0.5rem;
            overflow-x: auto;
        }
        .custom-card {
            background-color: var(--secondary-bg);
            border-radius: 0.75rem;
            border: 1px solid var(--border-color);
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            padding: 1.5rem;
        }
        .flow-arrow {
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .flow-arrow::after {
            content: '‚Üí';
            font-size: 2rem;
            color: var(--text-secondary);
            margin: 0 1rem;
        }
    </style>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body class="antialiased">

<div class="relative min-h-screen md:flex">
    <!-- Sidebar -->
    <aside id="sidebar" class="bg-white text-blue-100 w-64 space-y-6 py-7 px-2 absolute inset-y-0 left-0 transform -translate-x-full md:relative md:translate-x-0 transition duration-200 ease-in-out z-30 border-r border-slate-200">
        <a href="#" class="text-slate-800 flex items-center space-x-2 px-4">
            <svg class="w-8 h-8 text-teal-700" fill="none" stroke="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4"></path></svg>
            <span class="text-xl font-extrabold">Guia de Permiss√µes</span>
        </a>

        <nav id="nav-menu" class="text-slate-600 font-semibold">
            <a href="#intro" class="nav-link block py-2.5 px-4 rounded">Introdu√ß√£o</a>
            <a href="#why" class="nav-link block py-2.5 px-4 rounded">Por que Gerenciar?</a>
            <a href="#how" class="nav-link block py-2.5 px-4 rounded">Como Funciona</a>
            <a href="#identify" class="nav-link block py-2.5 px-4 rounded">Identificar Permiss√µes</a>
            <a href="#remove" class="nav-link block py-2.5 px-4 rounded">Remover Permiss√µes</a>
            <a href="#policies" class="nav-link block py-2.5 px-4 rounded">Pol√≠ticas da Meta</a>
            <a href="#troubleshooting" class="nav-link block py-2.5 px-4 rounded">Solu√ß√£o de Problemas</a>
        </nav>
    </aside>
    
    <!-- Mobile menu button -->
    <button id="mobile-menu-button" class="md:hidden fixed top-4 left-4 z-40 bg-white p-2 rounded-md shadow-lg">
        <svg class="h-6 w-6 text-slate-800" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16m-7 6h7" />
        </svg>
    </button>

    <!-- Content -->
    <main class="flex-1 p-4 sm:p-6 lg:p-10 prose-custom max-w-full">

        <section id="intro">
            <h1 class="text-4xl font-bold text-slate-900">Gerenciando Permiss√µes do Android em Apps Unreal para Meta Quest 3</h1>
            <p class="text-xl text-slate-600">Este guia interativo ajuda desenvolvedores Unreal Engine a navegar pelo complexo processo de gerenciamento de permiss√µes do Android para aplicativos do Meta Quest, garantindo conformidade com as pol√≠ticas da Meta e melhorando a seguran√ßa e a confian√ßa do usu√°rio.</p>
        </section>

        <section id="why">
            <h2><span class="text-teal-700">#</span> Por que Gerenciar Permiss√µes?</h2>
            <p>Gerenciar permiss√µes n√£o √© apenas uma tarefa t√©cnica; √© um pilar fundamental para o sucesso do seu aplicativo na loja Meta Quest. Um conjunto excessivo de permiss√µes pode levar a problemas significativos. Esta se√ß√£o explica por que voc√™ deve dedicar aten√ß√£o especial a este aspecto do desenvolvimento.</p>
            <div class="grid md:grid-cols-3 gap-6 mt-8 not-prose">
                <div class="custom-card text-center">
                    <div class="text-4xl mb-4">üõ°Ô∏è</div>
                    <h3 class="font-bold text-lg mb-2 text-slate-800">Conformidade e Submiss√£o</h3>
                    <p class="text-sm text-slate-500">A Meta possui diretrizes rigorosas. Permiss√µes desnecess√°rias, especialmente as que exigem revis√£o ou s√£o proibidas, podem levar √† rejei√ß√£o imediata do seu aplicativo, causando atrasos no lan√ßamento.</p>
                </div>
                <div class="custom-card text-center">
                    <div class="text-4xl mb-4">üë§</div>
                    <h3 class="font-bold text-lg mb-2 text-slate-800">Confian√ßa do Usu√°rio</h3>
                    <p class="text-sm text-slate-500">Solicitar permiss√µes irrelevantes (como acesso a chamadas telef√¥nicas) pode gerar desconfian√ßa e preocupa√ß√µes com a privacidade, levando a avalia√ß√µes negativas e menor n√∫mero de instala√ß√µes.</p>
                </div>
                <div class="custom-card text-center">
                    <div class="text-4xl mb-4">‚öôÔ∏è</div>
                    <h3 class="font-bold text-lg mb-2 text-slate-800">Desempenho e Estabilidade</h3>
                    <p class="text-sm text-slate-500">Embora sutil, um manifesto limpo com apenas as permiss√µes essenciais pode contribuir para um aplicativo mais est√°vel, com menor tamanho de APK e comportamento mais previs√≠vel.</p>
                </div>
            </div>
        </section>

        <section id="how">
            <h2><span class="text-teal-700">#</span> Como o Manifesto Funciona</h2>
             <p>A Unreal Engine gera o arquivo `AndroidManifest.xml` dinamicamente durante o empacotamento. Ele combina m√∫ltiplas fontes, resultando em um arquivo final que muitas vezes cont√©m mais permiss√µes do que o esperado. Entender esse processo de mesclagem √© crucial para saber como remov√™-las efetivamente.</p>
            <div class="mt-8 custom-card not-prose">
                <h3 class="text-center font-bold text-lg mb-6 text-slate-800">O Processo de Mesclagem do Manifesto</h3>
                <div class="flex flex-col md:flex-row items-center justify-center space-y-4 md:space-y-0 md:space-x-4">
                    <div class="flex flex-col space-y-2 items-center text-center">
                        <div class="p-4 bg-slate-100 rounded-lg shadow w-40">Padr√µes da Engine</div>
                        <div class="p-4 bg-slate-100 rounded-lg shadow w-40">Plugins Meta XR</div>
                        <div class="p-4 bg-slate-100 rounded-lg shadow w-40">Plugins de Terceiros</div>
                    </div>
                    <div class="flow-arrow hidden md:flex"></div>
                    <div class="md:hidden text-2xl">‚Üì</div>
                    <div class="p-6 bg-blue-100 rounded-lg shadow text-center">
                        <h4 class="font-bold text-blue-800">Mesclagem do Gradle</h4>
                        <p class="text-sm text-blue-600">Combina todas as fontes</p>
                    </div>
                    <div class="flow-arrow hidden md:flex"></div>
                    <div class="md:hidden text-2xl">‚Üì</div>
                     <div class="p-6 bg-teal-100 rounded-lg shadow text-center">
                        <h4 class="font-bold text-teal-800">Nosso Arquivo de Remo√ß√£o</h4>
                        <p class="text-sm text-teal-600">Aplica regras `tools:node="remove"`</p>
                    </div>
                     <div class="flow-arrow hidden md:flex"></div>
                     <div class="md:hidden text-2xl">‚Üì</div>
                    <div class="p-6 bg-green-100 rounded-lg shadow text-center">
                        <h4 class="font-bold text-green-800">APK Final</h4>
                        <p class="text-sm text-green-600">Manifesto limpo</p>
                    </div>
                </div>
                 <div class="mt-6 p-4 bg-amber-50 border-l-4 border-amber-400">
                     <p class="font-bold text-amber-800">O Segredo: `tools:node="remove"`</p>
                     <p class="text-sm text-amber-700">Este √© o atributo m√°gico. Quando voc√™ o adiciona a uma declara√ß√£o de permiss√£o em um arquivo de manifesto com alta prioridade (como o que vamos criar), ele instrui o processo de mesclagem a remover essa permiss√£o do APK final, mesmo que ela tenha sido adicionada por outra fonte.</p>
                 </div>
            </div>
        </section>

        <section id="identify">
            <h2><span class="text-teal-700">#</span> Identificar Permiss√µes</h2>
            <p>Antes de remover, voc√™ precisa saber quais permiss√µes seu aplicativo est√° solicitando. Existem v√°rias ferramentas para inspecionar o `AndroidManifest.xml` final do seu APK. A "fonte da verdade" √© sempre o Meta Horizon Developer Dashboard, pois √© o que a equipe de revis√£o da Meta utilizar√°.</p>
            <div class="mt-6 not-prose">
                <div class="custom-card">
                    <div class="border-b border-slate-200">
                        <nav class="-mb-px flex space-x-6" id="identify-tabs">
                            <button data-tab="tab-meta" class="tab-button-identify shrink-0 border-b-2 border-teal-500 px-1 py-4 text-sm font-medium text-teal-600">Meta Horizon Dashboard</button>
                            <button data-tab="tab-studio" class="tab-button-identify shrink-0 border-b-2 border-transparent px-1 py-4 text-sm font-medium text-slate-500 hover:border-slate-300 hover:text-slate-700">Android Studio</button>
                            <button data-tab="tab-aapt" class="tab-button-identify shrink-0 border-b-2 border-transparent px-1 py-4 text-sm font-medium text-slate-500 hover:border-slate-300 hover:text-slate-700">aapt.exe</button>
                        </nav>
                    </div>
                    <div class="py-6">
                        <div id="tab-meta" class="tab-content-identify">
                             <h3 class="font-semibold text-lg text-slate-800">Verifica√ß√£o Final (Recomendado)</h3>
                             <ol class="list-decimal list-inside mt-4 space-y-2 text-slate-600">
                                 <li>Fa√ßa o upload do seu APK para o <a href="https://developer.oculus.com/manage/" target="_blank" class="text-teal-600 hover:underline">Meta Horizon Developer Dashboard</a>.</li>
                                 <li>Navegue at√© "Distribution > Builds".</li>
                                 <li>Selecione a aba "Details" para a sua build.</li>
                                 <li>O painel exibir√° uma lista completa de todas as permiss√µes detectadas.</li>
                             </ol>
                        </div>
                        <div id="tab-studio" class="tab-content-identify hidden">
                             <h3 class="font-semibold text-lg text-slate-800">Inspe√ß√£o Local</h3>
                            <ol class="list-decimal list-inside mt-4 space-y-2 text-slate-600">
                                <li>No Android Studio, selecione `File > Profile or Debug APK`.</li>
                                <li>Escolha o seu arquivo APK empacotado.</li>
                                <li>Navegue pela √°rvore de diret√≥rios do APK e abra o `AndroidManifest.xml`.</li>
                                <li>Procure por todas as tags `<uses-permission>`.</li>
                            </ol>
                        </div>
                        <div id="tab-aapt" class="tab-content-identify hidden">
                             <h3 class="font-semibold text-lg text-slate-800">Linha de Comando R√°pida</h3>
                             <p class="text-slate-600">Use a ferramenta `aapt.exe` do Android SDK Build Tools com o seguinte comando:</p>
                             <pre class="mt-4"><code>aapt.exe dump permissions C:\caminho\para\SeuAPK.apk</code></pre>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="remove">
            <h2><span class="text-teal-700">#</span> Remover Permiss√µes</h2>
             <p>Esta se√ß√£o fornece as ferramentas interativas para gerar o c√≥digo necess√°rio para remover permiss√µes indesejadas do seu manifesto. Escolha o m√©todo que melhor se adapta ao seu projeto. Para a maioria dos casos (projetos Blueprint ou C++), o "M√©todo 1" √© o mais simples e recomendado.</p>
            <div class="mt-6 not-prose">
                 <div class="custom-card">
                     <div class="border-b border-slate-200">
                         <nav class="-mb-px flex space-x-6" id="remove-tabs">
                             <button data-tab="tab-method1" class="tab-button-remove shrink-0 border-b-2 border-teal-500 px-1 py-4 text-sm font-medium text-teal-600">M√©todo 1: Abordagem Simples (.txt)</button>
                             <button data-tab="tab-method2" class="tab-button-remove shrink-0 border-b-2 border-transparent px-1 py-4 text-sm font-medium text-slate-500 hover:border-slate-300 hover:text-slate-700">M√©todo 2: Abordagem C++</button>
                         </nav>
                     </div>
                     <div class="py-6">
                         <div id="tab-method1" class="tab-content-remove">
                             <h3 class="font-semibold text-lg text-slate-800">Usando `ManifestRequirementsAdditions.txt`</h3>
                             <ol class="list-decimal list-inside mt-4 space-y-2 text-slate-600">
                                <li>No diret√≥rio raiz do seu projeto, crie a estrutura de pastas: `Build\Android`.</li>
                                 <li>Dentro de `Build\Android`, crie um novo arquivo de texto chamado <strong>`ManifestRequirementsAdditions.txt`</strong>.</li>
                                 <li>Cole o c√≥digo gerado abaixo neste arquivo.</li>
                             </ol>
                             <div class="mt-6">
                                 <label for="permissions-input-1" class="block text-sm font-medium text-slate-700">Cole aqui as permiss√µes a remover (uma por linha):</label>
                                 <textarea id="permissions-input-1" rows="4" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm p-2" placeholder="android.permission.CALL_PHONE&#10;android.permission.READ_EXTERNAL_STORAGE"></textarea>
                                  <button id="generate-btn-1" class="mt-3 inline-flex items-center rounded-md border border-transparent bg-teal-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2">Gerar C√≥digo</button>
                             </div>
                             <div class="mt-4">
                                 <label class="block text-sm font-medium text-slate-700">C√≥digo gerado para `ManifestRequirementsAdditions.txt`:</label>
                                 <pre id="output-1" class="mt-1"><code class="language-xml">&lt;!-- Clique em 'Gerar C√≥digo' para ver o resultado --&gt;</code></pre>
                             </div>
                         </div>
                         <div id="tab-method2" class="tab-content-remove hidden">
                             <h3 class="font-semibold text-lg text-slate-800">Usando a Linguagem de Plugin da Unreal (C++)</h3>
                             <p class="text-slate-600">Este m√©todo oferece mais controle e √© ideal para projetos C++ que precisam aplicar regras condicionalmente.</p>
                             <h4 class="font-semibold mt-4 text-slate-700">Passo 1: Modifique `PROJECT_NAME.Build.cs`</h4>
                             <p class="text-slate-600">No arquivo `SeuProjeto\Source\SeuProjeto\PROJECT_NAME.Build.cs`, adicione o seguinte c√≥digo C#:</p>
                             <pre><code class="language-csharp">if (Target.Platform == UnrealTargetPlatform.Android && Target.Configuration == UnrealTargetConfiguration.Shipping) {
    var manifest_file = System.IO.Path.Combine(ModuleDirectory, "RemovePermissions.xml");
    AdditionalPropertiesForReceipt.Add("AndroidPlugin", manifest_file);
}</code></pre>
                             
                             <h4 class="font-semibold mt-6 text-slate-700">Passo 2: Crie e Popule `RemovePermissions.xml`</h4>
                              <ol class="list-decimal list-inside mt-2 space-y-2 text-slate-600">
                                <li>Na mesma pasta (`SeuProjeto\Source\SeuProjeto`), crie um arquivo XML chamado <strong>`RemovePermissions.xml`</strong>.</li>
                                <li>Use o gerador abaixo para criar o conte√∫do deste arquivo.</li>
                             </ol>

                              <div class="mt-6">
                                 <label for="permissions-input-2" class="block text-sm font-medium text-slate-700">Cole aqui as permiss√µes a remover (uma por linha):</label>
                                 <textarea id="permissions-input-2" rows="4" class="mt-1 block w-full rounded-md border-slate-300 shadow-sm focus:border-teal-500 focus:ring-teal-500 sm:text-sm p-2" placeholder="android.permission.WAKE_LOCK&#10;android.permission.WRITE_EXTERNAL_STORAGE"></textarea>
                                  <button id="generate-btn-2" class="mt-3 inline-flex items-center rounded-md border border-transparent bg-teal-600 px-4 py-2 text-sm font-medium text-white shadow-sm hover:bg-teal-700 focus:outline-none focus:ring-2 focus:ring-teal-500 focus:ring-offset-2">Gerar C√≥digo</button>
                             </div>
                             <div class="mt-4">
                                 <label class="block text-sm font-medium text-slate-700">C√≥digo gerado para `RemovePermissions.xml`:</label>
                                 <pre id="output-2" class="mt-1"><code class="language-xml">&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;root xmlns:android="http://schemas.android.com/apk/res/android"&gt;
    &lt;androidManifestUpdates&gt;
        &lt;!-- Clique em 'Gerar C√≥digo' para ver o resultado --&gt;
    &lt;/androidManifestUpdates&gt;
&lt;/root&gt;</code></pre>
                             </div>
                         </div>
                     </div>
                 </div>
            </div>
        </section>

        <section id="policies">
            <h2><span class="text-teal-700">#</span> Pol√≠ticas de Permiss√£o da Meta</h2>
            <p>A Meta tem pol√≠ticas claras sobre o que √© permitido. Algumas permiss√µes s√£o proibidas, enquanto outras exigem uma justificativa detalhada durante a submiss√£o. Use esta tabela pesquis√°vel para verificar rapidamente as pol√≠ticas para permiss√µes comuns e evitar rejei√ß√µes.</p>
            <div class="mt-6 custom-card not-prose">
                <input type="text" id="permission-search" placeholder="Pesquisar permiss√£o..." class="w-full p-2 mb-4 border border-slate-300 rounded-md shadow-sm">
                <div class="overflow-x-auto max-h-[600px]">
                    <table id="permissions-table" class="w-full text-sm text-left text-slate-500">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-50 sticky top-0">
                            <tr>
                                <th scope="col" class="py-3 px-6">Permiss√£o</th>
                                <th scope="col" class="py-3 px-6">Notas de Uso / Posi√ß√£o da Meta</th>
                            </tr>
                        </thead>
                        <tbody>
                            <!-- Table rows will be inserted here by JS -->
                        </tbody>
                    </table>
                </div>
            </div>
        </section>

        <section id="troubleshooting">
            <h2><span class="text-teal-700">#</span> Solu√ß√£o de Problemas Comuns</h2>
             <p>Mesmo seguindo os passos corretamente, problemas podem surgir. Esta se√ß√£o aborda os desafios mais comuns encontrados ao gerenciar permiss√µes, desde permiss√µes que se recusam a desaparecer at√© falhas de compila√ß√£o.</p>
            <div id="accordion-container" class="space-y-4 mt-6">
                <!-- Accordion items will be inserted here by JS -->
            </div>
        </section>

    </main>
</div>

<script>
document.addEventListener('DOMContentLoaded', function () {
    const mobileMenuButton = document.getElementById('mobile-menu-button');
    const sidebar = document.getElementById('sidebar');

    mobileMenuButton.addEventListener('click', () => {
        sidebar.classList.toggle('-translate-x-full');
    });

    // Close sidebar when clicking a link (for mobile)
    document.querySelectorAll('#sidebar nav a').forEach(link => {
        link.addEventListener('click', () => {
            if (window.innerWidth < 768) {
                sidebar.classList.add('-translate-x-full');
            }
        });
    });

    // Tab functionality
    function setupTabs(tabContainerId, buttonClass, contentClass) {
        const tabContainer = document.getElementById(tabContainerId);
        if (!tabContainer) return;

        const tabButtons = tabContainer.querySelectorAll(`.${buttonClass}`);
        const tabContents = document.querySelectorAll(`.${contentClass}`);

        tabButtons.forEach(button => {
            button.addEventListener('click', () => {
                tabButtons.forEach(btn => {
                    btn.classList.remove('border-teal-500', 'text-teal-600');
                    btn.classList.add('border-transparent', 'text-slate-500', 'hover:border-slate-300', 'hover:text-slate-700');
                });
                button.classList.add('border-teal-500', 'text-teal-600');
                button.classList.remove('border-transparent', 'text-slate-500');

                const targetTab = button.getAttribute('data-tab');
                tabContents.forEach(content => {
                    if (content.id === targetTab) {
                        content.classList.remove('hidden');
                    } else {
                        content.classList.add('hidden');
                    }
                });
            });
        });
    }

    setupTabs('identify-tabs', 'tab-button-identify', 'tab-content-identify');
    setupTabs('remove-tabs', 'tab-button-remove', 'tab-content-remove');


    // Code Generator
    const generateBtn1 = document.getElementById('generate-btn-1');
    const permissionsInput1 = document.getElementById('permissions-input-1');
    const output1 = document.getElementById('output-1');

    generateBtn1.addEventListener('click', () => {
        const permissions = permissionsInput1.value.trim().split('\n').filter(p => p);
        if (permissions.length === 0) {
            output1.innerHTML = `<code class="language-xml">&lt;!-- Adicione pelo menos uma permiss√£o na caixa de texto acima. --&gt;</code>`;
            return;
        }
        const generatedCode = permissions.map(p => `    &lt;uses-permission android:name="${p.trim()}" tools:node="remove" /&gt;`).join('\n');
        output1.innerHTML = `<code class="language-xml">${generatedCode}</code>`;
    });
    
    const generateBtn2 = document.getElementById('generate-btn-2');
    const permissionsInput2 = document.getElementById('permissions-input-2');
    const output2 = document.getElementById('output-2');
    
    generateBtn2.addEventListener('click', () => {
        const permissions = permissionsInput2.value.trim().split('\n').filter(p => p);
        let generatedCode = `&lt;?xml version="1.0" encoding="utf-8"?&gt;
&lt;root xmlns:android="http://schemas.android.com/apk/res/android"&gt;
    &lt;androidManifestUpdates&gt;
`;
        if (permissions.length === 0) {
           generatedCode += `        &lt;!-- Adicione pelo menos uma permiss√£o na caixa de texto acima. --&gt;`;
        } else {
             generatedCode += permissions.map(p => `        &lt;removePermission android:name="${p.trim()}" /&gt;`).join('\n');
        }

        generatedCode += `
    &lt;/androidManifestUpdates&gt;
&lt;/root&gt;`;
        output2.innerHTML = `<code class="language-xml">${generatedCode}</code>`;
    });


    // Permissions Table Data & Filtering
    const permissionsData = [
        { perm: 'ACCESS_MEDIA_LOCATION', note: 'Necess√°ria apenas se o aplicativo precisar ler dados Exif protegidos de arquivos de m√≠dia de armazenamento compartilhado. N√£o necess√°ria para ler ou gravar arquivos de m√≠dia de armazenamento compartilhado.' },
        { perm: 'BATTERY_STATS', note: 'Gerenciada pela plataforma. Considere um recurso de salvamento autom√°tico em seu aplicativo se estiver preocupado com bateria fraca.' },
        { perm: 'BLUETOOTH_CONNECT, BLUETOOTH_SCAN, etc.', note: 'Permitidas apenas para interoperabilidade com um dispositivo Bluetooth de terceiros que n√£o pode ser emparelhado de outra forma atrav√©s da interface Bluetooth do aplicativo Meta Quest.' },
        { perm: 'CAMERA', note: 'Usos permitidos incluem aplicativos constru√≠dos com Unity que usam `WebcamTexture`.' },
        { perm: 'CHANGE_WIFI_STATE', note: 'Aplicativos n√£o devem alterar as configura√ß√µes do dispositivo.' },
        { perm: 'FOREGROUND_SERVICE', note: 'Servi√ßos em segundo plano e em primeiro plano n√£o s√£o suportados atualmente.' },
        { perm: 'HEADSET_CAMERA', note: 'Usos permitidos incluem a identifica√ß√£o de objetos com os quais o aplicativo pode interagir.' },
        { perm: 'KILL_BACKGROUND_PROCESSES', note: 'Gerenciada pela plataforma.' },
        { perm: 'MANAGE_EXTERNAL_STORAGE', note: 'Usos permitidos incluem recursos de gerenciamento de arquivos.' },
        { perm: 'MODIFY_AUDIO_SETTINGS', note: 'Aplicativos n√£o devem alterar as configura√ß√µes do dispositivo.' },
        { perm: 'POST_NOTIFICATIONS', note: 'Aplicativos devem enviar notifica√ß√µes atrav√©s das ferramentas na aba "Engagement > User Notifications" do Meta Horizon Developer Dashboard, que n√£o exigem esta permiss√£o.' },
        { perm: 'READ_EXTERNAL_STORAGE', note: 'N√£o necess√°ria para salvar jogos; use armazenamento persistente com escopo de aplicativo. N√£o necess√°ria para DLC. N√£o necess√°ria para ler arquivos de m√≠dia de armazenamento compartilhado ou arquivos de m√≠dia criados pelo pr√≥prio aplicativo.' },
        { perm: 'READ_PHONE_STATE', note: 'Aplicativos n√£o devem acessar IDs de hardware.' },
        { perm: 'RECORD_AUDIO', note: 'Usos permitidos incluem VOIP ou outros recursos que precisam de acesso ao microfone.' },
        { perm: 'AVATAR_CAMERA', note: 'Usos permitidos incluem videoconfer√™ncia.' },
        { perm: 'WAKE_LOCK', note: 'Gerenciada pela plataforma.' },
        { perm: 'WRITE_EXTERNAL_STORAGE', note: 'N√£o necess√°ria para salvar jogos; use armazenamento persistente com escopo de aplicativo. N√£o necess√°ria para usar DLC. N√£o necess√°ria para gravar arquivos de m√≠dia de armazenamento compartilhado.' }
    ];

    const tableBody = document.querySelector('#permissions-table tbody');
    function populateTable(data) {
        tableBody.innerHTML = '';
        data.forEach(item => {
            const row = document.createElement('tr');
            row.className = 'bg-white border-b';
            row.innerHTML = `
                <td class="py-4 px-6 font-medium text-slate-900 whitespace-nowrap"><code>${item.perm}</code></td>
                <td class="py-4 px-6">${item.note}</td>
            `;
            tableBody.appendChild(row);
        });
    }

    populateTable(permissionsData);

    const searchInput = document.getElementById('permission-search');
    searchInput.addEventListener('keyup', () => {
        const searchTerm = searchInput.value.toLowerCase();
        const filteredData = permissionsData.filter(item => 
            item.perm.toLowerCase().includes(searchTerm) || 
            item.note.toLowerCase().includes(searchTerm)
        );
        populateTable(filteredData);
    });

    // Accordion data and creation
    const accordionData = [
        {
            title: "A permiss√£o persiste mesmo com `tools:node=\"remove\"`",
            content: "<strong>Causa:</strong> Geralmente, isso ocorre por um erro de sintaxe, aus√™ncia do namespace `tools` no manifesto final, o arquivo `ManifestRequirementsAdditions.txt` estar no local errado ou um manifesto de maior prioridade na cadeia de mesclagem estar readicionando a permiss√£o.<br><strong>Solu√ß√£o:</strong> Verifique a sintaxe e a localiza√ß√£o do arquivo (`Build/Android`). Garanta que seu m√©todo de remo√ß√£o tenha prioridade suficiente sobre a fonte que est√° adicionando a permiss√£o."
        },
        {
            title: "O aplicativo falha ou um recurso para de funcionar",
            content: "<strong>Causa:</strong> Voc√™ removeu uma permiss√£o essencial que um recurso principal do seu aplicativo ou uma biblioteca de terceiros necessita.<br><strong>Solu√ß√£o:</strong> Re-adicione a permiss√£o suspeita e teste sistematicamente para identificar qual funcionalidade foi afetada. Consulte a tabela de pol√≠ticas da Meta para entender as depend√™ncias comuns e evite remover permiss√µes que s√£o, de fato, necess√°rias."
        },
        {
            title: "Falhas de compila√ß√£o relacionadas ao Android SDK/NDK/Java",
            content: "<strong>Causa:</strong> Configura√ß√£o incorreta do ambiente de desenvolvimento Android. Isso pode incluir a vari√°vel de ambiente `JAVA_HOME` errada, vers√µes incompat√≠veis do SDK/NDK ou n√≠veis de API que n√£o correspondem aos requisitos da sua vers√£o da Unreal Engine.<br><strong>Solu√ß√£o:</strong> Em `Project Settings > Platforms > Android SDK`, verifique se todos os caminhos (SDK, NDK, Java) est√£o corretos e se os n√≠veis de API s√£o compat√≠veis com sua vers√£o da UE."
        },
        {
            title: "Upload bloqueado por `debuggable` definido como `true`",
            content: "<strong>Causa:</strong> O seu APK foi empacotado como uma constru√ß√£o de 'Debug' ou 'Development', que n√£o s√£o permitidas para submiss√£o √† loja da Meta.<br><strong>Solu√ß√£o:</strong> Certifique-se de que voc√™ est√° empacotando seu projeto com a configura√ß√£o de constru√ß√£o (Build Configuration) definida como 'Shipping' na Unreal Engine."
        }
    ];

    const accordionContainer = document.getElementById('accordion-container');
    accordionData.forEach((item, index) => {
        const accordionItem = document.createElement('div');
        accordionItem.className = 'custom-card';
        accordionItem.innerHTML = `
            <h3 class="mb-0">
                <button
                    type="button"
                    class="flex w-full items-center justify-between text-left font-semibold text-lg"
                    aria-expanded="false"
                    aria-controls="accordion-content-${index}"
                >
                    <span>${item.title}</span>
                    <span class="ml-6 flex-shrink-0">
                         <svg class="h-6 w-6 transform transition-transform duration-200" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" d="M19.5 8.25l-7.5 7.5-7.5-7.5" />
                        </svg>
                    </span>
                </button>
            </h3>
            <div id="accordion-content-${index}" class="prose-custom max-w-none mt-2 pr-12 hidden">
                <p>${item.content}</p>
            </div>
        `;
        accordionContainer.appendChild(accordionItem);

        const button = accordionItem.querySelector('button');
        const content = accordionItem.querySelector(`#accordion-content-${index}`);
        const icon = button.querySelector('svg');

        button.addEventListener('click', () => {
            const isExpanded = button.getAttribute('aria-expanded') === 'true';
            button.setAttribute('aria-expanded', !isExpanded);
            content.classList.toggle('hidden');
            icon.classList.toggle('rotate-180');
        });
    });

    // Active nav link on scroll
    const sections = document.querySelectorAll('main section');
    const navLinks = document.querySelectorAll('#nav-menu a');

    const observer = new IntersectionObserver((entries) => {
        entries.forEach(entry => {
            if (entry.isIntersecting) {
                navLinks.forEach(link => {
                    link.classList.toggle('active', link.getAttribute('href').substring(1) === entry.target.id);
                });
            }
        });
    }, { rootMargin: "-30% 0px -70% 0px" });

    sections.forEach(section => {
        observer.observe(section);
    });

});
</script>

</body>
</html>
